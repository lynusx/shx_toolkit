# EL图片收集功能测试指南

## 测试目录结构

已创建测试数据目录：

```
test_data/
└── line_10.108.8.232/
    └── SaveImages/
        └── A-01-B/
            └── 20260206/
                └── 白班/
                    ├── 8/
                    │   ├── NG_脏污_B/
                    │   │   ├── EL_001.png
                    │   │   └── EL_002.png
                    │   └── NG_划伤_B/
                    │   └── NG_断删_B/
                    ├── 9/
                    │   ├── NG_脏污_B/
                    │   └── NG_划伤_B/
                    │       └── EL_003.png
                    ├── 10/
                    │   └── NG_断删_B/
                    │       └── EL_004.png
                    └── 14/
                        └── NG_脏污_B/
                            └── EL_005.png
```

## 测试步骤

### 1. 运行Dart测试脚本

```bash
dart test_el_collection.dart
```

这个脚本会：
- 创建测试配置（config/line_config.json）
- 扫描测试目录
- 复制图片到 test_output 目录

### 2. 运行Flutter应用

```bash
flutter run -d macos
```

### 3. 在应用中使用测试配置

当前侧边栏菜单：
- **离线EL** - 进入EL图片收集页面
- **设置** - 应用设置

在离线EL页面：
1. 选择线别：**测试线别-1A**
2. 输入日期：**20260206**
3. 选择班次：**白班**
4. 选择时间段：**8, 9, 10, 14**（已找到图片的时间段）
5. 选择脏污类型：**脏污、划伤、断删**
6. 点击 **"开始扫描"**
7. 选择目标目录
8. 点击 **"开始复制"**

## 预期结果

扫描应找到 **5 张图片**：
- EL_001.png (8点/脏污)
- EL_002.png (8点/脏污)
- EL_003.png (9点/划伤)
- EL_004.png (10点/断删)
- EL_005.png (14点/脏污)

## 生产环境配置

生产环境需要修改 `config/line_config.json`：

```json
{
  "东区": {
    "1A": "\\\\10.108.8.232",
    "1B": "\\\\10.108.8.231",
    ...
  },
  "西区": {
    "1A": "\\\\10.108.229.131",
    ...
  }
}
```

## 功能特点

### 1. 智能剪枝
- 目录不存在时自动跳过
- 不会继续扫描子目录
- 提高扫描效率

### 2. 路径自动生成
- 日期：自动生成 yyyyMMdd 格式
- 班次：根据当前时间自动判断
  - 白班：8:30 - 20:30
  - 夜班：20:30 - 8:30
- 时间段：根据班次自动列出

### 3. 多选支持
- 可同时选择多个时间段
- 可同时选择多种脏污类型
- 支持全选/清空操作

## 常见问题

### Q: 找不到图片？
A: 检查以下几点：
1. 线别配置是否正确
2. 日期格式是否为 yyyyMMdd
3. 目录路径是否匹配

### Q: 扫描很慢？
A: 正常现象，因为：
1. 需要遍历多个层级
2. 每个时间段都要检查
3. 每个脏污类型都要扫描

### Q: 图片复制失败？
A: 检查：
1. 目标目录是否有写入权限
2. 磁盘空间是否充足
3. 源文件是否存在
